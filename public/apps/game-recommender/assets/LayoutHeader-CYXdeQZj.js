import{a as s,p as t,x,y as w,w as v}from"./chunk-OIYGIGL5-D4m_JISv.js";import{h as M,i as C,p as P,m as d}from"./proxy-BTL25mS4.js";import{A as S,s as R,g as f}from"./gameapi.service-Dm-zwIsS.js";import{L}from"./LoadingScreen-nx6LrMIA.js";import{S as g,s as T}from"./searchStateContext-mAK-N42P.js";function N(){!M.current&&C();const[a]=s.useState(P.current);return a}function $(){const a=N(),[i,u]=s.useState([]);s.useEffect(()=>{if(a)return;const e=window.innerWidth<768,n=e?3:5,l=Array.from({length:n},(p,h)=>({id:h,x:Math.random()*100,y:Math.random()*100,size:e?30+Math.random()*40:40+Math.random()*60,duration:15+Math.random()*10,delay:h*2,shape:["circle","square","triangle"][Math.floor(Math.random()*3)]}));u(l)},[a]);function c(e,n){switch(e){case"circle":return t.jsx("circle",{cx:n/2,cy:n/2,r:n/2,fill:"currentColor"});case"square":return t.jsx("rect",{width:n,height:n,fill:"currentColor"});case"triangle":const l=`${n/2},0 ${n},${n} 0,${n}`;return t.jsx("polygon",{points:l,fill:"currentColor"})}}return t.jsxs("header",{className:"animated-header",children:[t.jsx(d.div,{className:"gradient-background",initial:{opacity:0},animate:{opacity:1},transition:{duration:1},children:t.jsx("div",{className:"igdb-subtitle",children:"Powered by IGDB"})}),!a&&i.length>0&&t.jsx("div",{className:"shapes-container",children:i.map(e=>t.jsx(d.div,{className:"floating-shape",style:{left:`${e.x}%`,top:`${e.y}%`,width:e.size,height:e.size},initial:{opacity:0,scale:0},animate:{opacity:[.1,.3,.1],scale:[1,1.2,1],rotate:[0,360],y:[-20,20,-20]},transition:{duration:e.duration,delay:e.delay,repeat:1/0,ease:"easeInOut"},children:t.jsx("svg",{width:e.size,height:e.size,viewBox:`0 0 ${e.size} ${e.size}`,children:c(e.shape,e.size)})},e.id))}),t.jsxs(d.div,{className:"header-content",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},children:[t.jsx(d.h1,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.4},children:"Game Recommendations"}),t.jsx(d.p,{className:"header-subtitle",initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.6},children:"Discover your next favorite game"})]})]})}function b(){const a=x(),i=w();return t.jsx(S,{mode:"wait",initial:!0,children:i&&s.cloneElement(i,{key:a.pathname})})}function E(){const a=x(),[i,u]=s.useState(null),[c,e]=s.useState({tags:[],offset:0}),[n,l]=s.useState(!0);s.useEffect(()=>{async function o(){try{const[r,m,y]=await Promise.all([f.getPlatforms(),f.getGenres(),f.getKeywords()]);u({platformTags:r,genreTags:m,keywordTags:y})}catch(r){console.error("Failed to load tags:",r),u({platformTags:[],genreTags:[],keywordTags:[]})}finally{l(!1)}}o()},[]),s.useEffect(()=>{if(!i)return;const o=g.getSearchPathFromLocation(a.pathname);if(o){const{tags:r,offset:m}=g.parseSearchPath(o,i);r.length>0&&e(y=>({tags:r,offset:m}))}},[i]),s.useEffect(()=>{if(!(a.pathname==="/"||a.pathname.startsWith("/search")))return;const r=c.tags.length>0?g.buildSearchUrl(c.tags,c.offset):"/";a.pathname!==r&&window.history.replaceState(null,"",r)},[c,a.pathname]);function p(o){e(r=>({...r,tags:o}))}function h(o){e(r=>({...r,offset:o}))}const j={searchTags:c.tags,currentOffset:c.offset,setSearchTags:p,setCurrentOffset:h};return n?t.jsx(S,{mode:"wait",children:t.jsx(L,{})}):t.jsx(R.Provider,{value:i,children:t.jsx(T.Provider,{value:j,children:t.jsxs("div",{className:"app-container",children:[t.jsx($,{}),t.jsx("main",{children:t.jsx(b,{})})]})})})}const D=v(E);export{D as default};
