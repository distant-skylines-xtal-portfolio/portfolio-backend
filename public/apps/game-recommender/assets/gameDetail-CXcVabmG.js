import{A as B,B as U,a as r,C as A,p as e,w as F}from"./chunk-OIYGIGL5-D4m_JISv.js";import{s as K,g as d}from"./gameapi.service-Dm-zwIsS.js";import{T as m,c as H}from"./RateLimiter-swVSsLao.js";import{L as W}from"./LoadingScreen-nx6LrMIA.js";import{m as q}from"./proxy-BTL25mS4.js";function z(){let c=B(),o=U();const n=r.useContext(K),[D]=A(),[S,h]=r.useState(!0),[w,x]=r.useState(!1),[L,g]=r.useState(!1),[i,k]=r.useState(null),[f,$]=r.useState([]),[u,G]=r.useState([]),[j,P]=r.useState(null),N=D.get("from");if(!c.id)return e.jsx(e.Fragment,{});const p=parseInt(c.id);function R(a){return!n||!a?[]:a.map(s=>{const t=n.genreTags.find(l=>l.id===s);return t?{id:t.id,name:t.name}:null}).filter(s=>s!==null)}function I(a){return!n||!a?[]:a.map(s=>{const t=n.platformTags.find(l=>l.id===s);return t?{id:t.id,name:t.name}:null}).filter(s=>s!==null)}function T(a){return!n||!a?[]:a.map(s=>{const t=n.keywordTags.find(l=>l.id===s);return t?{id:t.id,name:t.name}:null}).filter(s=>s!==null)}r.useEffect(()=>{async function a(){try{h(!0);const s=await H.add(async()=>await d.getFullInfo(p));if(k(s),s.cover)try{const t=await d.getCover(p);t.success&&P(t.imageUrl)}catch(t){console.error("Error fetching cover:",t)}if(s.release_dates&&s.release_dates.length>0){x(!0);try{const t=await d.getReleaseDates(s.id);$(t)}catch(t){console.error("Error fetching release dates:",t)}finally{x(!1)}}if(s.similar_games&&s.similar_games.length>0){g(!0);try{const t=await d.getSimilarGames(s.similar_games.slice(0,7));G(t)}catch(t){console.error("Error fetching similar games:",t)}finally{g(!1)}}}catch(s){console.error("Error Getting full game info: ",s)}finally{h(!1)}}a()},[c.id]);function v(){if(N){const a=`/search/${decodeURIComponent(N)}`;o(a)}else o("/")}function J(a,s){}function E(a){return a?new Date(a*1e3).toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"numeric"}):"TBA"}if(S)return e.jsx(W,{});if(!i)return e.jsxs("div",{className:"detail-page",children:[e.jsx("div",{className:"navigate-header",children:e.jsx("button",{className:"button-text",onClick:v,children:"Back to Home"})}),e.jsx("div",{className:"error-container",children:e.jsx("p",{children:"Failed to load game information."})})]});const y=R(i.genres||[]),b=I(i.platforms||[]),C=T(i.keywords||[]).slice(0,10);function _(a){let s=n?.platformTags.find(t=>t.id===a.platformId);return s?s.name:"Unknown"}return e.jsxs("div",{className:"detail-page","data-testid":"detail-page",children:[e.jsx("div",{className:"navigate-header",children:e.jsx("button",{className:"button-text",onClick:v,children:"Back to Home"})}),e.jsx("div",{className:"game-info-title-container",children:e.jsx("h1",{className:"text-detail-header","data-testid":"text-detail-header",children:i.name})}),e.jsx("div",{className:"cover-container",children:j?e.jsx("img",{src:j,alt:`${i.name} cover`,className:"detail-cover-image"}):e.jsx("div",{className:"cover-placeholder",children:"No Cover Available"})}),e.jsx("div",{className:"basic-info-container",children:e.jsxs("div",{className:"game-info-summary-container",children:[e.jsx("h2",{className:"text-detail-header",children:"Summary"}),e.jsx("p",{className:"body-text",children:i.summary||"No summary available."})]})}),e.jsxs("div",{className:"detail-tags-container",children:[e.jsxs("div",{className:"detail-tag-section",children:[e.jsx("h3",{className:"text-detail-body",children:"Genres"}),e.jsx("div",{className:"tags-container",children:y.length>0?y.map(a=>e.jsx(m,{id:`genre-${a.id}`,text:a.name,ariaLabel:`Genre: ${a.name}`,canDelete:!1,handleClick:()=>(a.name,void 0)},`genre-${a.id}`)):e.jsx("p",{className:"text-muted",children:"No genres listed"})})]}),e.jsxs("div",{className:"detail-tag-section",children:[e.jsx("h3",{className:"text-detail-body",children:"Platforms"}),e.jsx("div",{className:"tags-container",children:b.length>0?b.map(a=>e.jsx(m,{id:`platform-${a.id}`,text:a.name,ariaLabel:`Platform: ${a.name}`,canDelete:!1,handleClick:()=>(a.name,void 0)},`platform-${a.id}`)):e.jsx("p",{className:"text-muted",children:"No platforms listed"})})]}),e.jsxs("div",{className:"detail-tag-section",children:[e.jsx("h3",{className:"text-detail-body",children:"Keywords"}),e.jsx("div",{className:"tags-container",children:C.length>0?C.map(a=>e.jsx(m,{id:`keyword-${a.id}`,text:a.name,ariaLabel:`Keyword: ${a.name}`,canDelete:!1,handleClick:()=>(a.name,void 0)},`keyword-${a.id}`)):e.jsx("p",{className:"text-muted",children:"No keywords listed"})})]})]}),e.jsxs("div",{className:"releases-container",children:[e.jsx("h2",{className:"text-detail-header",children:"Release Dates"}),w?e.jsx("p",{className:"text-muted",children:"Loading release dates..."}):f.length>0?e.jsxs("table",{className:"releases-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Platform"}),e.jsx("th",{children:"Region"}),e.jsx("th",{children:"Date"})]})}),e.jsx("tbody",{children:f.map((a,s)=>e.jsxs("tr",{children:[e.jsx("td",{children:_(a)}),e.jsx("td",{children:a.region||"Worldwide"}),e.jsx("td",{children:E(a.date)})]},`release-${s}`))})]}):e.jsx("p",{className:"text-muted",children:"No release date information available"})]}),i.similar_games&&i.similar_games.length>0&&e.jsxs("div",{className:"similar-games-container",children:[e.jsx("h2",{className:"text-detail-header",children:"Similar Games"}),L?e.jsx("p",{className:"text-muted",children:"Loading similar games..."}):u.length>0?e.jsx("div",{className:"similar-games-list",children:u.map(a=>e.jsx("div",{className:"similar-game-item",onClick:()=>o(`/game/${a.id}`),children:e.jsx("p",{className:"similar-game-name",children:a.name})},`similar-${a.id}`))}):e.jsx("p",{className:"text-muted",children:"No similar games found"})]})]})}function Y(){return[{title:"Game Detail"},{name:"Game Details",content:"Details for selected game"}]}const Z=F(function(){return e.jsx(q.div,{className:"home-page",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:e.jsx(z,{})})});export{Z as default,Y as meta};
